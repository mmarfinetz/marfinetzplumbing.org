<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">
  <title>MMW Contracting - Professional Plumbing Services in Pennsylvania</title>
  <meta name="description" content="MMW Contracting offers professional plumbing services including fixture replacements, drain services, water heater installation, and bathroom upgrades in Pennsylvania.">
  <meta name="keywords" content="plumbing, contractor, Pennsylvania, fixture replacement, drain services, water heater, bathroom remodeling, MMW Contracting">
  <meta name="author" content="MMW Contracting">
  <meta property="og:title" content="MMW Contracting - Professional Plumbing Services">
  <meta property="og:description" content="Reliable plumbing services for residential and commercial properties in Pennsylvania.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://mmwcontracting.org">
  <meta name="theme-color" content="#008080">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" type="image/jpeg" href="img/logo_local.jpeg">
  
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Preload critical assets -->
  <link rel="preload" href="img/logo_local.jpeg" as="image">
  <link rel="preload" href="img/mycomputer.png" as="image">
  <link rel="preload" href="img/services.png" as="image">
  <link rel="preload" href="img/phone.png" as="image">
  
  <!-- Critical CSS inlined -->
  <style>
    /* Inlined critical CSS */
    @import url('css/critical.css');
  </style>
  
  <!-- Non-critical CSS loaded asynchronously -->
  <link rel="preload" href="css/win97.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="css/win97.css"></noscript>
  
  <!-- Mobile CSS -->
  <link rel="stylesheet" href="css/mobile.css">
  
  <!-- Google Fonts loaded asynchronously -->
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  
  <!-- Deferred JavaScript -->
  <script src="js/google-reviews.js" defer></script>
  <script src="js/main.js" defer></script>
</head>
<body>
  <!-- Mobile Navigation Menu -->
  <div class="mobile-nav">
    <button class="mobile-nav-toggle">
      <span class="mobile-nav-icon"></span>
    </button>
    <div class="mobile-nav-logo">MMW Contracting</div>
    <a href="tel:8142736315" class="mobile-nav-call">
      <img src="img/phone.png" alt="Call" width="24" height="24">
    </a>
  </div>
  
  <div class="mobile-menu">
    <div class="mobile-menu-header">
      <img src="img/logo_local.jpeg" alt="MMW Contracting" width="40" height="40">
      <span>MMW Contracting</span>
    </div>
    <div class="mobile-menu-items">
      <a href="#" class="mobile-menu-item" data-window="services">
        <img src="img/services.png" alt="Services" width="24" height="24">
        <span>Services</span>
      </a>
      <a href="contact-form.html" class="mobile-menu-item">
        <img src="img/phone.png" alt="Contact Us" width="24" height="24">
        <span>Contact Us</span>
      </a>
      <a href="#" class="mobile-menu-item" data-window="testimonials">
        <img src="img/wxp_244.png" alt="Reviews" width="24" height="24">
        <span>Customer Reviews</span>
      </a>
      <a href="#" class="mobile-menu-item" data-window="emergency">
        <img src="img/w98_msg_warning.png" alt="Emergency" width="24" height="24">
        <span>Emergency Services</span>
      </a>
      <a href="#" class="mobile-menu-item" data-window="help">
        <img src="img/help.png" alt="Help" width="24" height="24">
        <span>Help</span>
      </a>
    </div>
  </div>
  
  <div class="desktop-icons">
    <a href="#" class="desktop-icon" id="my-computer">
      <img src="img/mycomputer.png" alt="My Computer">
      <span>My Computer</span>
    </a>
    <a href="#" class="desktop-icon" id="services">
      <img src="img/services.png" alt="Services">
      <span>Services</span>
    </a>
    <a href="#" class="desktop-icon" id="contact">
      <img src="img/phone.png" alt="Contact Us">
      <span>Contact Us</span>
    </a>
    <a href="#" class="desktop-icon" id="testimonials">
      <img src="img/wxp_244.png" alt="Reviews">
      <span>Customer Reviews</span>
    </a>
    <a href="#" class="desktop-icon" id="emergency">
      <img src="img/w98_msg_warning.png" alt="Emergency Services">
      <span>Emergency Services</span>
    </a>
    <!-- Video icon removed
    <div class="desktop-icon" style="left: 20px; top: 260px;">
      <img src="img/wxp_186.png" alt="Video">
      <span>Company Video</span>
    </div>
    -->
  </div>
  
  <div class="cta-button-container">
    <button class="cta-button">
      <img src="img/wxp_299.png" alt="Request" style="width: 20px; height: 20px; margin-right: 5px;">
      Request Plumbing Service
    </button>
  </div>

  <div class="window" style="left: 200px; top: 50px; display: none;">
    <div class="title-bar">
      <div class="title-bar-text">MMW Contracting - Plumbing Services</div>
      <div class="title-bar-controls">
        <button class="title-bar-button">_</button>
        <button class="title-bar-button">□</button>
        <button class="title-bar-button">×</button>
      </div>
    </div>
    <div class="window-content">
      <div class="services-grid">
        <!-- Fixture Replacements -->
        <div class="service-category">
          <div class="title-bar">
            <div class="title-bar-text">Fixture Replacements</div>
          </div>
          <div class="window-content">
            <div class="service-item">
              <img src="img/wxp_186.png" alt="Faucet" class="service-icon">
              <span>Faucets & Sinks Installation</span>
            </div>
            <div class="service-item">
              <img src="img/wxp_220.png" alt="Shower" class="service-icon">
              <span>Showerheads & Toilets</span>
            </div>
            <div class="service-item">
              <img src="img/w2k_old_dustbin.png" alt="Disposal" class="service-icon">
              <span>Garbage Disposals</span>
            </div>
            <div class="service-item">
              <img src="img/w2k_search.png" alt="Filter" class="service-icon">
              <span>Water Filters & Hot Water Dispensers</span>
            </div>
          </div>
        </div>

        <!-- Drain & Sewer -->
        <div class="service-category">
          <div class="title-bar">
            <div class="title-bar-text">Drain & Sewer Services</div>
          </div>
          <div class="window-content">
            <div class="service-item">
              <img src="img/wxp_317.png" alt="Drain" class="service-icon">
              <span>Drain Snaking & Sewer Cabling</span>
            </div>
            <div class="service-item">
              <img src="img/wxp_180.png" alt="Pipe" class="service-icon">
              <span>P-traps & Pop-up Assemblies</span>
            </div>
            <div class="service-item">
              <img src="img/wxp_154.png" alt="Leak" class="service-icon">
              <span>Minor Leak Repairs</span>
            </div>
          </div>
        </div>

        <!-- Water Heaters -->
        <div class="service-category">
          <div class="title-bar">
            <div class="title-bar-text">Water Heater Services</div>
          </div>
          <div class="window-content">
            <div class="service-item">
              <img src="img/wxp_244.png" alt="Heater" class="service-icon">
              <span>Electric Water Heater Replacement</span>
            </div>
            <div class="service-item">
              <img src="img/wxp_167.png" alt="Tankless" class="service-icon">
              <span>Tankless Water Heater Installation</span>
            </div>
          </div>
        </div>

        <!-- Remodeling -->
        <div class="service-category">
          <div class="title-bar">
            <div class="title-bar-text">Bathroom Upgrades</div>
          </div>
          <div class="window-content">
            <div class="service-item">
              <img src="img/wxp_237.png" alt="Vanity" class="service-icon">
              <span>Vanities & Countertops</span>
            </div>
            <div class="service-item">
              <img src="img/wxp_299.png" alt="Shower Door" class="service-icon">
              <span>Shower Doors & Grab Bars</span>
            </div>
            <div class="service-item">
              <img src="img/wxp_267.png" alt="Tile" class="service-icon">
              <span>Tile & Tub Enclosures</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="start-menu">
    <div class="start-menu-item" id="start-emergency" style="background-color: #cc0000; color: white;">
      <img src="img/w98_msg_warning.png" alt="Emergency">
      <span>Emergency Services</span>
    </div>
    <div class="start-menu-item" id="start-services">
      <img src="img/services.png" alt="Services">
      <span>Services</span>
    </div>
    <div class="start-menu-item" id="start-contact">
      <img src="img/phone.png" alt="Contact">
      <span>Contact Us</span>
    </div>
    <div class="start-menu-item" id="start-testimonials">
      <img src="img/wxp_244.png" alt="Reviews">
      <span>Customer Reviews</span>
    </div>
    <div class="start-menu-divider"></div>
    <div class="start-menu-item" id="start-help">
      <img src="img/help.png" alt="Help">
      <span>Help</span>
    </div>
    <div class="start-menu-item" id="start-shutdown">
      <img src="img/shutdown.png" alt="Shut Down">
      <span>Shut Down...</span>
    </div>
  </div>

  <div class="taskbar">
    <button class="start-button">
      <img src="img/win-logo.png" alt="Start" style="width: 16px; height: 16px; margin-right: 5px;">
      <span>Start</span>
    </button>
    <div class="taskbar-entries"></div>
    <div class="emergency-taskbar" onclick="document.getElementById('emergency-window').style.display='block'">
      <img src="img/w98_msg_warning.png" alt="Emergency" style="width: 16px; height: 16px; margin-right: 5px;">
      <span>EMERGENCY 24/7: 814-273-6315</span>
    </div>
    <div class="taskbar-time">4:20 PM</div>
  </div>

  <!-- Page Transition Element -->
  <div class="page-transition">
    <div class="page-transition-content">
      <div class="hourglass"></div>
      <div class="loading-text">Loading...</div>
    </div>
  </div>

  <!-- Emergency Services Window -->
  <div class="window emergency-window" id="emergency-window" data-window="emergency" style="left: 50%; top: 50%; transform: translate(-50%, -50%); width: 500px; min-height: 300px; z-index: 999;">
    <div class="title-bar" style="background-color: #cc0000;">
      <div class="title-bar-text">EMERGENCY PLUMBING SERVICES</div>
      <div class="title-bar-controls">
        <button class="title-bar-button">_</button>
        <button class="title-bar-button">□</button>
        <button class="title-bar-button">×</button>
      </div>
    </div>
    <div class="window-content emergency-content">
      <div class="emergency-header">
        <img src="img/w98_msg_warning.png" alt="Emergency" class="emergency-icon">
        <h2 class="emergency-title">EMERGENCY 24/7 PLUMBING SERVICES</h2>
      </div>
      <div class="emergency-info">
        <p class="emergency-text">Serving Erie County, Pennsylvania</p>
        <p class="emergency-phone">Call Now: <a href="tel:8142736315" class="emergency-phone-link">814-273-6315</a></p>
        <div class="emergency-services-list">
          <div class="emergency-service-item">
            <img src="img/pipe2.png" alt="Pipe" class="service-icon">
            <span>Burst Pipes</span>
          </div>
          <div class="emergency-service-item">
            <img src="img/faucet.png" alt="Leak" class="service-icon">
            <span>Major Leaks</span>
          </div>
          <div class="emergency-service-item">
            <img src="img/heater.png" alt="Heater" class="service-icon">
            <span>No Hot Water</span>
          </div>
          <div class="emergency-service-item">
            <img src="img/w98_hardware.png" alt="Toilet" class="service-icon">
            <span>Toilet Issues</span>
          </div>
          <div class="emergency-service-item">
            <img src="img/w98_gps.png" alt="Drain" class="service-icon">
            <span>Sewer Backup</span>
          </div>
          <div class="emergency-service-item">
            <img src="img/warning.png" alt="Flood" class="service-icon">
            <span>Flooding</span>
          </div>
        </div>
        <button class="emergency-call-button" onclick="window.location.href='tel:8142736315'">
          <img src="img/phone.png" alt="Call" style="width: 24px; height: 24px; margin-right: 10px;">
          CALL NOW
        </button>
      </div>
    </div>
  </div>

  <!-- Help Window Template -->
  <div class="window" id="help-window" style="display: none; left: 250px; top: 100px; width: 400px; min-height: 200px;">
    <div class="title-bar">
      <div class="title-bar-text">Help - Contact Information</div>
      <div class="title-bar-controls">
        <button class="title-bar-button">_</button>
        <button class="title-bar-button">□</button>
        <button class="title-bar-button">×</button>
      </div>
    </div>
    <div class="window-content" style="font-family: 'Courier New', monospace; white-space: pre-line;">
      MMW Contracting Contact Information:

      Email: admin@mmwcontracting.org
      Phone: 814-273-6315
      PA HIC #: PA198563
    </div>
  </div>

  <!-- Video Window Template - Commented out
  <div class="window" id="video-window" style="display: none; left: 250px; top: 100px; width: 640px; min-height: 480px;">
    <div class="title-bar">
      <div class="title-bar-text">MMW Contracting - Company Video</div>
      <div class="title-bar-controls">
        <button class="title-bar-button">_</button>
        <button class="title-bar-button">□</button>
        <button class="title-bar-button">×</button>
      </div>
    </div>
    <div class="window-content" style="padding: 0;">
      <video 
        width="100%" 
        height="480" 
        controls
        style="background: black;"
      >
        <source src="img/Spongebob - Where's The Leak Ma'am.mp4?v=2" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
  </div>
  -->

  <!-- Calculator Window Template -->
  <!-- Removed as per instructions -->

  <!-- Testimonials Window Template -->
  <div class="window" id="testimonials-window" data-window="testimonials" style="display: none; left: 300px; top: 100px; width: 500px; height: 400px;">
    <div class="title-bar">
      <div class="title-bar-text">Customer Reviews</div>
      <div class="title-bar-controls">
        <button class="title-bar-button">_</button>
        <button class="title-bar-button">□</button>
        <button class="title-bar-button">×</button>
      </div>
    </div>
    <div class="window-content testimonials-content">
      <div class="testimonial">
        <div class="testimonial-header">
          <img src="img/wxp_186.png" alt="User" class="testimonial-icon">
          <div class="testimonial-user">
            <div class="testimonial-name">John D.</div>
            <div class="testimonial-rating">★★★★★</div>
          </div>
        </div>
        <div class="testimonial-text">
          "Excellent service! Fixed my leaky faucet quickly and professionally. Would recommend to anyone needing plumbing work done."
        </div>
      </div>
      <div class="testimonial">
        <div class="testimonial-header">
          <img src="img/wxp_186.png" alt="User" class="testimonial-icon">
          <div class="testimonial-user">
            <div class="testimonial-name">Sarah M.</div>
            <div class="testimonial-rating">★★★★★</div>
          </div>
        </div>
        <div class="testimonial-text">
          "MMW Contracting installed a new bathroom vanity for us. The work was done perfectly and they cleaned up everything afterward. Very satisfied!"
        </div>
      </div>
      <div class="testimonial">
        <div class="testimonial-header">
          <img src="img/wxp_186.png" alt="User" class="testimonial-icon">
          <div class="testimonial-user">
            <div class="testimonial-name">Robert T.</div>
            <div class="testimonial-rating">★★★★☆</div>
          </div>
        </div>
        <div class="testimonial-text">
          "Needed emergency plumbing repair and they responded quickly. Fair pricing and good workmanship. Would use again."
        </div>
      </div>
      <div class="nav-buttons">
        <button class="win95-button prev-testimonial">◄ Previous</button>
        <button class="win95-button next-testimonial">Next ►</button>
      </div>
    </div>
  </div>

  <script>
    // Update taskbar time
    function updateTime() {
      const now = new Date();
      const timeStr = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
      document.querySelector('.taskbar-time').textContent = timeStr;
    }
    setInterval(updateTime, 1000);
    updateTime();

    // Mobile menu toggle
    document.querySelector('.mobile-nav-toggle').addEventListener('click', function() {
      document.querySelector('.mobile-menu').classList.toggle('active');
      this.classList.toggle('active');
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.mobile-menu') && !e.target.closest('.mobile-nav-toggle')) {
        document.querySelector('.mobile-menu').classList.remove('active');
        document.querySelector('.mobile-nav-toggle').classList.remove('active');
      }
    });

    // Mobile menu item click handlers
    document.querySelectorAll('.mobile-menu-item[data-window]').forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        const windowId = this.getAttribute('data-window');
        const targetWindow = document.querySelector(`.window[data-window="${windowId}"]`);
        
        if (targetWindow) {
          // Hide all windows first
          document.querySelectorAll('.window').forEach(w => {
            w.style.display = 'none';
            w.classList.remove('active');
          });
          
          // Show the target window
          targetWindow.style.display = 'block';
          targetWindow.classList.add('active');
          
          // Close the mobile menu
          document.querySelector('.mobile-menu').classList.remove('active');
          document.querySelector('.mobile-nav-toggle').classList.remove('active');
        }
      });
    });

    // Page Loading Simulation
    window.addEventListener('DOMContentLoaded', function() {
      const pageTransition = document.querySelector('.page-transition');
      pageTransition.classList.add('active');
      
      setTimeout(function() {
        pageTransition.classList.remove('active');
        
        // Show emergency window after page loads
        setTimeout(function() {
          const emergencyWindow = document.getElementById('emergency-window');
          emergencyWindow.style.display = 'block';
          
          // Add taskbar entry for emergency window
          let taskbarEntry = document.querySelector('.taskbar-entry[data-window="emergency"]');
          if (!taskbarEntry) {
            taskbarEntry = document.createElement('div');
            taskbarEntry.className = 'taskbar-entry active';
            taskbarEntry.setAttribute('data-window', 'emergency');
            taskbarEntry.innerHTML = `
              <img src="img/w98_msg_warning.png" alt="Emergency" style="width: 16px; height: 16px; margin-right: 5px;">
              <span>Emergency Services</span>
            `;
            document.querySelector('.taskbar-entries').appendChild(taskbarEntry);
          }
          
          // Bring window to front
          document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
          emergencyWindow.classList.add('active');
          
          // Make sure all other windows are hidden
          document.querySelectorAll('.window:not(#emergency-window)').forEach(w => {
            w.style.display = 'none';
          });
          
          // Make sure all other taskbar entries are not active
          document.querySelectorAll('.taskbar-entry:not([data-window="emergency"])').forEach(entry => {
            entry.classList.remove('active');
          });
        }, 500);
      }, 1500);
    });

    // Detect if device is mobile
    function isMobileDevice() {
      return (window.innerWidth <= 768) || 
             (navigator.maxTouchPoints > 0) ||
             (navigator.msMaxTouchPoints > 0);
    }

    // Apply mobile-specific behaviors
    function applyMobileBehaviors() {
      if (isMobileDevice()) {
        // Make windows non-draggable on mobile
        document.querySelectorAll('.window').forEach(window => {
          const titleBar = window.querySelector('.title-bar');
          if (titleBar) {
            titleBar.style.cursor = 'default';
          }
        });
        
        // Show mobile nav
        document.querySelector('.mobile-nav').style.display = 'flex';
        
        // Make emergency call button more prominent
        const emergencyCallBtn = document.querySelector('.emergency-call-button');
        if (emergencyCallBtn) {
          emergencyCallBtn.style.fontSize = '18px';
          emergencyCallBtn.style.padding = '15px';
        }
      }
    }

    // Call on page load and resize
    window.addEventListener('DOMContentLoaded', applyMobileBehaviors);
    window.addEventListener('resize', applyMobileBehaviors);

    // Testimonials Navigation
    const testimonials = document.querySelectorAll('.testimonial');
    let currentTestimonialIndex = 0;
    
    // Initially hide all but the first testimonial
    for (let i = 1; i < testimonials.length; i++) {
      testimonials[i].style.display = 'none';
    }
    
    document.querySelector('.prev-testimonial').addEventListener('click', function() {
      testimonials[currentTestimonialIndex].style.display = 'none';
      currentTestimonialIndex = (currentTestimonialIndex - 1 + testimonials.length) % testimonials.length;
      testimonials[currentTestimonialIndex].style.display = 'block';
    });
    
    document.querySelector('.next-testimonial').addEventListener('click', function() {
      testimonials[currentTestimonialIndex].style.display = 'none';
      currentTestimonialIndex = (currentTestimonialIndex + 1) % testimonials.length;
      testimonials[currentTestimonialIndex].style.display = 'block';
    });
    
    // CTA Button Click Handler
    document.querySelector('.cta-button').addEventListener('click', function() {
      window.location.href = 'contact-form.html';
    });

    // Window management
    document.querySelectorAll('.window').forEach(window => {
      let isDragging = false;
      let currentX;
      let currentY;
      let initialX;
      let initialY;

      // Set data-window attribute for identification
      if (window.id === 'help-window') {
        window.setAttribute('data-window', 'help');
      /* Video window identification removed
      } else if (window.id === 'video-window') {
        window.setAttribute('data-window', 'video');
      */
      } else if (window.id === 'testimonials-window') {
        window.setAttribute('data-window', 'testimonials');
      } else if (window.id === 'emergency-window') {
        window.setAttribute('data-window', 'emergency');
      } else {
        window.setAttribute('data-window', 'services');
      }

      const titleBar = window.querySelector('.title-bar');
      const minimizeButton = window.querySelector('.title-bar-button:nth-child(1)');
      const maximizeButton = window.querySelector('.title-bar-button:nth-child(2)');
      const closeButton = window.querySelector('.title-bar-button:nth-child(3)');

      // Only create taskbar entries for windows that should be visible initially
      // Skip the main services window since we only want to show the emergency window
      if (window.getAttribute('data-window') !== 'services') {
        // Create taskbar entry for the window
        const taskbarEntry = document.createElement('div');
        taskbarEntry.className = 'taskbar-entry';
        taskbarEntry.setAttribute('data-window', window.getAttribute('data-window'));
        
        // Set appropriate icon based on window type
        let iconSrc = 'img/services.png';  // Default
        let windowType = window.getAttribute('data-window');
        
        if (windowType === 'help') {
          iconSrc = 'img/phone.png';
        } else if (windowType === 'testimonials') {
          iconSrc = 'img/wxp_244.png';
        } else if (windowType === 'calculator') {
          iconSrc = 'img/w98_calculator.png';
        } else if (windowType === 'emergency') {
          iconSrc = 'img/w98_msg_warning.png';
        }
        
        taskbarEntry.innerHTML = `
          <img src="${iconSrc}" alt="Window" style="width: 16px; height: 16px; margin-right: 5px;">
          <span>${window.querySelector('.title-bar-text').textContent}</span>
        `;
        
        // Only add to taskbar if it's not the main services window
        document.querySelector('.taskbar-entries').appendChild(taskbarEntry);
      }

      // Minimize button click handler
      minimizeButton.addEventListener('click', () => {
        window.style.display = 'none';
        taskbarEntry.classList.remove('active');
        taskbarEntry.style.display = 'block'; // Keep taskbar entry visible
      });

      // Taskbar entry click handler
      taskbarEntry.addEventListener('click', () => {
        if (window.style.display === 'none') {
          window.style.display = 'block';
          taskbarEntry.classList.add('active');
          // Bring window to front
          document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
          window.classList.add('active');
          /* Video autoplay removed
          // Auto-play video if it's the video window
          if (window.id === 'video-window') {
            const videoElement = window.querySelector('video');
            videoElement.play();
          }
          */
        } else {
          window.style.display = 'none';
          taskbarEntry.classList.remove('active');
          /* Video pause removed
          // Pause video if it's the video window
          if (window.id === 'video-window') {
            const videoElement = window.querySelector('video');
            videoElement.pause();
          }
          */
        }
      });

      // Close button click handler
      closeButton.addEventListener('click', () => {
        window.style.display = 'none';
        taskbarEntry.style.display = 'none';
      });

      titleBar.addEventListener('mousedown', (e) => {
        if (!e.target.closest('.title-bar-controls')) {
          isDragging = true;
          window.classList.add('dragging');
          
          const rect = window.getBoundingClientRect();
          initialX = e.clientX - rect.left;
          initialY = e.clientY - rect.top;
          
          // Bring window to front
          document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
          window.classList.add('active');
        }
      });

      document.addEventListener('mousemove', (e) => {
        if (isDragging) {
          e.preventDefault();
          const left = e.clientX - initialX;
          const top = e.clientY - initialY;
          
          window.style.left = `${left}px`;
          window.style.top = `${top}px`;
        }
      });

      document.addEventListener('mouseup', () => {
        if (isDragging) {
          isDragging = false;
          window.classList.remove('dragging');
        }
      });
    });

    // Desktop icons click handling
    document.querySelectorAll('.desktop-icon').forEach(icon => {
      icon.addEventListener('click', () => {
        // Remove any existing selection
        document.querySelectorAll('.desktop-icon').forEach(i => i.classList.remove('selected'));
        // Add selection to clicked icon
        icon.classList.add('selected');
        
        // Handle icon actions
        const iconText = icon.querySelector('span').textContent;
        if (iconText === 'Contact Us') {
          window.location.href = 'contact-form.html';
        } else if (iconText === 'Services') {
          document.querySelector('.window[data-window="services"]').style.display = 'block';
          document.querySelector('.taskbar-entry[data-window="services"]').classList.add('active');
        } else if (iconText === 'Customer Reviews') {
          document.querySelector('#testimonials-window').style.display = 'block';
          document.querySelector('.taskbar-entry[data-window="testimonials"]').classList.add('active');
          // Reset to first testimonial
          const testimonials = document.querySelectorAll('.testimonial');
          testimonials.forEach((t, i) => {
            t.style.display = i === 0 ? 'block' : 'none';
          });
        } else if (iconText === 'Emergency Services') {
          // Show emergency window and bring to front
          const emergencyWindow = document.getElementById('emergency-window');
          emergencyWindow.style.display = 'block';
          
          // Bring window to front
          document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
          emergencyWindow.classList.add('active');
          
          // Ensure taskbar entry exists and is active
          let taskbarEntry = document.querySelector('.taskbar-entry[data-window="emergency"]');
          if (!taskbarEntry) {
            taskbarEntry = document.createElement('div');
            taskbarEntry.className = 'taskbar-entry active';
            taskbarEntry.setAttribute('data-window', 'emergency');
            taskbarEntry.innerHTML = `
              <img src="img/w98_msg_warning.png" alt="Emergency" style="width: 16px; height: 16px; margin-right: 5px;">
              <span>Emergency Services</span>
            `;
            document.querySelector('.taskbar-entries').appendChild(taskbarEntry);
          }
          document.querySelectorAll('.taskbar-entry').forEach(entry => entry.classList.remove('active'));
          taskbarEntry.classList.add('active');
        /* Video click handler removed
        } else if (iconText === 'Company Video') {
          const videoWindow = document.querySelector('#video-window');
          const videoElement = videoWindow.querySelector('video');
          videoWindow.style.display = 'block';
          document.querySelector('.taskbar-entry[data-window="video"]').classList.add('active');
          // Auto-play the video
          videoElement.play();
        */
        }
      });
    });

    // Start menu functionality
    const startButton = document.querySelector('.start-button');
    const startMenu = document.querySelector('.start-menu');

    startButton.addEventListener('click', () => {
      startButton.classList.toggle('active');
      startMenu.classList.toggle('active');
    });

    // Close start menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.start-menu') && !e.target.closest('.start-button')) {
        startButton.classList.remove('active');
        startMenu.classList.remove('active');
      }
    });

    // Window controls
    document.querySelectorAll('.title-bar-button').forEach(button => {
      button.addEventListener('click', (e) => {
        const window = e.target.closest('.window');
        const buttonIndex = Array.from(e.target.parentElement.children).indexOf(e.target);
        const taskbarEntry = document.querySelector(`.taskbar-entry[data-window="${window.getAttribute('data-window')}"]`);
        
        switch(buttonIndex) {
          case 0: // Minimize
            window.style.display = 'none';
            if (taskbarEntry) {
              taskbarEntry.style.display = 'block';
              taskbarEntry.classList.remove('active');
            }
            /* Video pause removed
            // Pause video if it's the video window
            if (window.id === 'video-window') {
              const videoElement = window.querySelector('video');
              videoElement.pause();
            }
            */
            break;
          case 1: // Maximize
            if (window.style.width === '100%') {
              window.style.width = '800px';
              window.style.height = '600px';
              window.style.top = '50px';
              window.style.left = '200px';
            } else {
              window.style.width = '100%';
              window.style.height = 'calc(100vh - 30px)';
              window.style.top = '0';
              window.style.left = '0';
            }
            break;
          case 2: // Close
            window.style.display = 'none';
            if (taskbarEntry) {
              taskbarEntry.style.display = 'none';
            }
            /* Video pause removed
            // Pause video if it's the video window
            if (window.id === 'video-window') {
              const videoElement = window.querySelector('video');
              videoElement.pause();
            }
            */
            break;
        }
      });
    });

    // Shutdown functionality
    document.getElementById('start-shutdown').addEventListener('click', () => {
      location.reload();
    });

    // Start menu items click handlers
    document.getElementById('start-emergency').addEventListener('click', () => {
      // Show emergency window and bring to front
      const emergencyWindow = document.getElementById('emergency-window');
      emergencyWindow.style.display = 'block';
      
      // Bring window to front
      document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
      emergencyWindow.classList.add('active');
      
      // Ensure taskbar entry exists and is active
      let taskbarEntry = document.querySelector('.taskbar-entry[data-window="emergency"]');
      if (!taskbarEntry) {
        taskbarEntry = document.createElement('div');
        taskbarEntry.className = 'taskbar-entry active';
        taskbarEntry.setAttribute('data-window', 'emergency');
        taskbarEntry.innerHTML = `
          <img src="img/w98_msg_warning.png" alt="Emergency" style="width: 16px; height: 16px; margin-right: 5px;">
          <span>Emergency Services</span>
        `;
        document.querySelector('.taskbar-entries').appendChild(taskbarEntry);
      }
      document.querySelectorAll('.taskbar-entry').forEach(entry => entry.classList.remove('active'));
      taskbarEntry.classList.add('active');
      
      document.querySelector('.start-menu').classList.remove('active');
      document.querySelector('.start-button').classList.remove('active');
    });
    
    document.getElementById('start-services').addEventListener('click', () => {
      document.querySelector('.window[data-window="services"]').style.display = 'block';
      document.querySelector('.taskbar-entry[data-window="services"]').classList.add('active');
      document.querySelector('.start-menu').classList.remove('active');
      document.querySelector('.start-button').classList.remove('active');
    });

    document.getElementById('start-contact').addEventListener('click', () => {
      document.querySelector('.window[data-window="help"]').style.display = 'block';
      document.querySelector('.taskbar-entry[data-window="help"]').classList.add('active');
      document.querySelector('.start-menu').classList.remove('active');
      document.querySelector('.start-button').classList.remove('active');
    });

    document.getElementById('start-testimonials').addEventListener('click', () => {
      document.querySelector('.window[data-window="testimonials"]').style.display = 'block';
      document.querySelector('.taskbar-entry[data-window="testimonials"]').classList.add('active');
      document.querySelector('.start-menu').classList.remove('active');
      document.querySelector('.start-button').classList.remove('active');
    });

    document.getElementById('start-help').addEventListener('click', () => {
      document.querySelector('.window[data-window="help"]').style.display = 'block';
      document.querySelector('.taskbar-entry[data-window="help"]').classList.add('active');
      document.querySelector('.start-menu').classList.remove('active');
      document.querySelector('.start-button').classList.remove('active');
    });
  </script>
</body>
</html>
